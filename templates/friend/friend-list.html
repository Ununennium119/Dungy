{% extends "base.html" %}
{% load static %}
{% load startswith %}

{% block title %}
    Friends | Dungy
{% endblock %}

{% block content %}
    <div>
        <h2>Friends</h2>
        {% for friend in friends %}
            <div>
                <span>{{ friend.username }} ({{ friend.email }})</span>
            </div>
        {% endfor %}
        <hr>
        <h2>Sent Friend Requests</h2>
        {% for frient_request in sent_friend_requests %}
            <div>
                <span>
                    Friend Request to {{ frient_request.receiver.username }} ({{ frient_request.receiver.email }})
                </span>
                <form action="{% url "cancel-friend-request" %}" method="post" style="display: inline">
                    {% csrf_token %}
                    <input type="hidden" name="username" value="{{ frient_request.receiver.username }}">
                    <button type="submit">Cancel</button>
                </form>
            </div>
        {% endfor %}
        <hr>
        <h2>Received Friend Requests</h2>
        {% for frient_request in received_friend_requests %}
            <div>
                <span>
                    Friend Request from {{ frient_request.sender.username }} ({{ frient_request.sender.email }})
                </span>
                <form action="{% url "accept-friend-request" %}" method="post" style="display: inline">
                    {% csrf_token %}
                    <input type="hidden" name="username" value="{{ frient_request.sender.username }}">
                    <button type="submit">Accept</button>
                </form>
                <form action="{% url "reject-friend-request" %}" method="post" style="display: inline">
                    {% csrf_token %}
                    <input type="hidden" name="username" value="{{ frient_request.sender.username }}">
                    <button type="submit">Reject</button>
                </form>
            </div>
        {% endfor %}
        <hr>
        <form id="sort-form" method="get" action="{% url 'friends-list' %}">
            <label for="friends-sort-by">Sort Friends By</label>
            <select id="friends-sort-by" name="friends-sort-by">
                <option value="username-asc" {% if friends_sort_by == 'username-asc' %}selected=""{% endif %}>
                    Username &#8593
                </option>
                <option value="username-desc" {% if friends_sort_by == 'username-desc' %}selected=""{% endif %}>
                    Username &#8595
                </option>
                <option value="email-asc" {% if friends_sort_by == 'email-asc' %}selected=""{% endif %}>
                    Email &#8593
                </option>
                <option value="email-desc" {% if friends_sort_by == 'email-desc' %}selected=""{% endif %}>
                    Email &#8595
                </option>
            </select>
            <br>
            <label for="sent-sort-by">Sort Sent Friend Requests By</label>
            <select id="sent-sort-by" name="sent-sort-by">
                <option value="oldest" {% if sent_sort_by == 'oldest' %}selected=""{% endif %}>
                    Oldest
                </option>
                <option value="newest" {% if sent_sort_by == 'newest' %}selected=""{% endif %}>
                    Newest
                </option>
                <option value="username-asc" {% if sent_sort_by == 'username-asc' %}selected=""{% endif %}>
                    Username &#8593
                </option>
                <option value="username-desc" {% if sent_sort_by == 'username-desc' %}selected=""{% endif %}>
                    Username &#8595
                </option>
                <option value="email-asc" {% if sent_sort_by == 'email-asc' %}selected=""{% endif %}>
                    Email &#8593
                </option>
                <option value="email-desc" {% if sent_sort_by == 'email-desc' %}selected=""{% endif %}>
                    Email &#8595
                </option>
            </select>
            <br>
            <label for="received-sort-by">Sort Received Friend Requests By</label>
            <select id="received-sort-by" name="received-sort-by">
                <option value="oldest" {% if received_sort_by == 'oldest' %}selected=""{% endif %}>
                    Oldest
                </option>
                <option value="newest" {% if received_sort_by == 'newest' %}selected=""{% endif %}>
                    Newest
                </option>
                <option value="username-asc" {% if received_sort_by == 'username-asc' %}selected=""{% endif %}>
                    Username &#8593
                </option>
                <option value="username-desc" {% if received_sort_by == 'username-desc' %}selected=""{% endif %}>
                    Username &#8595
                </option>
                <option value="email-asc" {% if received_sort_by == 'email-asc' %}selected=""{% endif %}>
                    Email &#8593
                </option>
                <option value="email-desc" {% if received_sort_by == 'email-desc' %}selected=""{% endif %}>
                    Email &#8595
                </option>
            </select>
            <br>
            <button type="submit">Apply</button>
        </form>
        <br>
        <a href="{% url "add-friend" %}">Add Friend</a>
        <br>
        <a href="{% url "dashboard" %}">Back</a>
    </div>
{% endblock %}

